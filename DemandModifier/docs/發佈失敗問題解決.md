# ç™¼ä½ˆå¤±æ•—å•é¡Œè§£æ±ºå ±å‘Š

**æ—¥æœŸ**ï¼š2025å¹´10æœˆ28æ—¥  
**å•é¡Œ**ï¼šä½¿ç”¨ `PublishNewVersion.pubxml` ç™¼ä½ˆæ™‚å¤±æ•—  
**ç‹€æ…‹**ï¼šâœ… å·²è§£æ±º

## å•é¡Œæè¿°

åŸ·è¡Œ `dotnet publish /p:PublishProfile=PublishNewVersion` æ™‚å‡ºç¾ä»¥ä¸‹éŒ¯èª¤ï¼š

```
error MSB3231: ç„¡æ³•ç§»é™¤ç›®éŒ„ "C:\Users\zheng\AppData\LocalLow\Colossal Order\Cities Skylines II\Mods\DemandModifier"ã€‚
Access to the path 'DemandModifier_win_x86_64.dll' is denied.
```

## æ ¹æœ¬åŸå› 

**ModPublisher.exe çš„ç™¼ä½ˆæµç¨‹**ï¼š
1. åˆªé™¤èˆŠç‰ˆæ¨¡çµ„ç›®éŒ„ `Mods\DemandModifier\`
2. è¤‡è£½æ–°ç‰ˆæœ¬æª”æ¡ˆ
3. ä¸Šå‚³åˆ° PDX Mods å¹³å°

**å•é¡Œ**ï¼šç•¶ Cities: Skylines 2 éŠæˆ²æ­£åœ¨åŸ·è¡Œæ™‚ï¼Œæ¨¡çµ„çš„ DLL æª”æ¡ˆæœƒè¢«éŠæˆ²è¼‰å…¥ä¸¦é–å®šï¼Œå°è‡´ ModPublisher ç„¡æ³•åˆªé™¤èˆŠæª”æ¡ˆã€‚

## è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ³• 1ï¼šé—œé–‰éŠæˆ²å¾Œç™¼ä½ˆï¼ˆæ¨è–¦ï¼‰

```powershell
# 1. é—œé–‰ Cities: Skylines 2
# 2. åŸ·è¡Œç™¼ä½ˆå‘½ä»¤
dotnet publish /p:PublishProfile=PublishNewVersion

# æˆ–ä½¿ç”¨å¿«é€Ÿè…³æœ¬
.\scripts\quick-publish.ps1
```

### æ–¹æ³• 2ï¼šä½¿ç”¨è‡ªå‹•åŒ–è…³æœ¬

æ›´æ–° `quick-publish.ps1` åŠ å…¥éŠæˆ²é€²ç¨‹æª¢æŸ¥ï¼š

```powershell
# æª¢æŸ¥éŠæˆ²æ˜¯å¦æ­£åœ¨åŸ·è¡Œ
$gameProcess = Get-Process -Name "Cities2" -ErrorAction SilentlyContinue
if ($gameProcess) {
    Write-Host "âŒ åµæ¸¬åˆ°éŠæˆ²æ­£åœ¨åŸ·è¡Œä¸­ï¼" -ForegroundColor Red
    Write-Host "è«‹å…ˆé—œé–‰ Cities: Skylines 2 å†åŸ·è¡Œç™¼ä½ˆã€‚" -ForegroundColor Yellow
    exit 1
}

# ç¹¼çºŒç™¼ä½ˆæµç¨‹
dotnet publish /p:PublishProfile=PublishNewVersion
```

## æ­£ç¢ºçš„ç™¼ä½ˆæµç¨‹

### å®Œæ•´æ­¥é©Ÿ

1. **æ›´æ–°ç‰ˆæœ¬è³‡è¨Š**ï¼ˆ`Properties\PublishConfiguration.xml`ï¼‰
   ```xml
   <ModVersion Value="0.0.7" />
   <ChangeLog Value="ä¿®æ­£å…§å®¹..." />
   ```

2. **ç¢ºèªè®Šæ›´å·²æäº¤**
   ```powershell
   git add .
   git commit -m "v0.0.7: æ›´æ–°å…§å®¹"
   ```

3. **é—œé–‰éŠæˆ²**
   - å®Œå…¨é€€å‡º Cities: Skylines 2
   - ç¢ºèªå·¥ä½œç®¡ç†å“¡ä¸­ç„¡ `Cities2.exe` é€²ç¨‹

4. **åŸ·è¡Œç™¼ä½ˆ**
   ```powershell
   # æ–¹æ³• Aï¼šä½¿ç”¨å¿«é€Ÿè…³æœ¬
   .\scripts\quick-publish.ps1

   # æ–¹æ³• Bï¼šä½¿ç”¨ dotnet å‘½ä»¤
   dotnet publish /p:PublishProfile=PublishNewVersion
   ```

5. **é©—è­‰ç™¼ä½ˆ**
   - ç™»å…¥ [PDX Mods](https://mods.paradoxplaza.com/)
   - æª¢æŸ¥æ¨¡çµ„é é¢æ˜¯å¦æ›´æ–°

6. **æ¨™è¨˜ Git ç‰ˆæœ¬**
   ```powershell
   git tag v0.0.7
   git push origin master --tags
   ```

## é é˜²æªæ–½

### é–‹ç™¼éšæ®µæª¢æŸ¥æ¸…å–®

- [ ] æ›´æ–° `<ModVersion>` ç‰ˆæœ¬è™Ÿ
- [ ] æ’°å¯« `<ChangeLog>` æ›´æ–°æ—¥èªŒ
- [ ] æœ¬æ©Ÿæ¸¬è©¦æ‰€æœ‰åŠŸèƒ½
- [ ] æäº¤æ‰€æœ‰è®Šæ›´åˆ° Git
- [ ] **é—œé–‰éŠæˆ²**ï¼ˆé‡è¦ï¼ï¼‰
- [ ] åŸ·è¡Œç™¼ä½ˆå‘½ä»¤
- [ ] é©—è­‰ PDX Mods å¹³å°
- [ ] æ¨™è¨˜ Git ç‰ˆæœ¬

### å»ºè­°çš„è‡ªå‹•åŒ–æ”¹é€²

å»ºç«‹ `scripts\safe-publish.ps1`ï¼š

```powershell
param([switch]$Force)

# æª¢æŸ¥éŠæˆ²é€²ç¨‹
$gameProcess = Get-Process -Name "Cities2" -ErrorAction SilentlyContinue
if ($gameProcess -and -not $Force) {
    Write-Host "âš ï¸  åµæ¸¬åˆ°éŠæˆ²æ­£åœ¨åŸ·è¡Œä¸­ï¼" -ForegroundColor Yellow
    $response = Read-Host "æ˜¯å¦å¼·åˆ¶çµ‚æ­¢éŠæˆ²ä¸¦ç¹¼çºŒï¼Ÿ(y/N)"
    if ($response -eq 'y') {
        Stop-Process -Name "Cities2" -Force
        Start-Sleep -Seconds 2
    } else {
        Write-Host "âŒ å·²å–æ¶ˆç™¼ä½ˆ" -ForegroundColor Red
        exit 1
    }
}

# æª¢æŸ¥æœªæäº¤çš„è®Šæ›´
$gitStatus = git status --porcelain
if ($gitStatus) {
    Write-Host "âš ï¸  åµæ¸¬åˆ°æœªæäº¤çš„è®Šæ›´ï¼š" -ForegroundColor Yellow
    git status -s
    $response = Read-Host "æ˜¯å¦ç¹¼çºŒç™¼ä½ˆï¼Ÿ(y/N)"
    if ($response -ne 'y') {
        exit 1
    }
}

# åŸ·è¡Œç™¼ä½ˆ
Write-Host "ğŸš€ é–‹å§‹ç™¼ä½ˆ..." -ForegroundColor Green
dotnet publish /p:PublishProfile=PublishNewVersion

if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ… ç™¼ä½ˆæˆåŠŸï¼" -ForegroundColor Green
} else {
    Write-Host "âŒ ç™¼ä½ˆå¤±æ•—ï¼" -ForegroundColor Red
    exit $LASTEXITCODE
}
```

## æŠ€è¡“ç´°ç¯€

### ModPublisher å·¥å…·è¡Œç‚º

```
ModPublisher.exe NewVersion <PublishConfiguration.xml> -c <ModsPath> -v
```

**åŸ·è¡Œæµç¨‹**ï¼š
1. è®€å– `PublishConfiguration.xml`
2. é©—è­‰ `<ModId>` å­˜åœ¨ï¼ˆNewVersion æ¨¡å¼å¿…é ˆï¼‰
3. **åˆªé™¤** `<ModsPath>\DemandModifier\` ç›®éŒ„
4. å»ºç½®ä¸¦è¤‡è£½æ–°ç‰ˆæœ¬åˆ°è©²ç›®éŒ„
5. æ‰“åŒ…ä¸¦ä¸Šå‚³åˆ° PDX Mods
6. æ›´æ–°ç·šä¸Š Metadata

**é—œéµé™åˆ¶**ï¼šæ­¥é©Ÿ 3 éœ€è¦å®Œå…¨çš„æª”æ¡ˆå­˜å–æ¬Šï¼Œä»»ä½•è¢«é–å®šçš„æª”æ¡ˆéƒ½æœƒå°è‡´å¤±æ•—ã€‚

### Windows æª”æ¡ˆé–å®šæ©Ÿåˆ¶

- .NET Assembly (DLL) è¢«è¼‰å…¥åˆ°é€²ç¨‹å¾Œæœƒè¢«é–å®š
- å³ä½¿æ¨¡çµ„è¢«éŠæˆ²ã€Œåœç”¨ã€ï¼ŒDLL ä»åœ¨è¨˜æ†¶é«”ä¸­
- å¿…é ˆå®Œå…¨çµæŸéŠæˆ²é€²ç¨‹æ‰æœƒé‡‹æ”¾é–å®š

## ç›¸é—œæª”æ¡ˆ

- `Properties\PublishProfiles\PublishNewVersion.pubxml` - ç™¼ä½ˆè¨­å®šæª”
- `Properties\PublishConfiguration.xml` - æ¨¡çµ„ Metadata
- `scripts\quick-publish.ps1` - å¿«é€Ÿç™¼ä½ˆè…³æœ¬

## åƒè€ƒé€£çµ

- [Cities: Skylines 2 Modding Documentation](https://cs2.paradoxwikis.com/Modding)
- [PDX Mods Platform](https://mods.paradoxplaza.com/)
