# 🎯 問題已解決！完整說明

## 你遇到的問題

錯誤訊息：
```
錯誤 MSB3073: "ModPublisher.exe" 命令以返回碼 -1 結束。
```

## 真正的原因

**不是你的設定檔有問題！** 真正的原因是：

```
Could not auto log in: You were not logged in before. 
Launch the game and log in or pass email and password as args
```

**ModPublisher 需要你的 Paradox 帳號登入資訊才能上傳模組到 Paradox Mods。**

---

## ✅ 立即解決方案

### 步驟 1：在遊戲中登入（5 分鐘）

1. **啟動 Cities: Skylines 2**
   
2. **點擊主選單右上角的「登入」按鈕**
   - 輸入你的 Paradox 帳號（電子郵件）
   - 輸入密碼
   - ✅ 確認「記住我」有勾選
   
3. **等待登入成功**
   - 你會在右上角看到你的使用者名稱
   
4. **正常關閉遊戲**
   - 點擊「結束遊戲」
   - 確保遊戲完全關閉

### 步驟 2：發行你的模組

```powershell
# 切換到專案目錄
cd e:\Code\CSL2\DemandModifier\DemandModifier\DemandModifier

# 清理並建置
dotnet clean
dotnet build -c Release

# 發行到 Paradox Mods
dotnet publish /p:PublishProfile=PublishNewVersion
```

**就這樣！** 現在應該會成功了 🎉

---

## 📚 我為你建立的文件

我已經建立了完整的文件來幫助你：

### 1. 📘 版本發行完整指南
**檔案**：`docs\版本發行完整指南.md`

包含：
- ✅ 發行前準備檢查清單
- ✅ 版本號更新規則
- ✅ 完整發行流程
- ✅ 常見錯誤與解決方案
- ✅ 建立縮圖指南

### 2. 📄 快速參考卡
**檔案**：`docs\快速參考.md`

包含：
- ⚡ 最常用命令
- ⚡ 5 分鐘標準流程
- ⚡ 錯誤快速排除
- ⚡ 重要連結

### 3. 🔑 解決登入問題
**檔案**：`docs\解決登入問題.md`

包含：
- 🔓 兩種登入方法
- 🔓 詳細步驟說明
- 🔓 常見問題解答
- 🔓 安全提醒

### 4. 🚀 快速發行腳本
**檔案**：`quick-publish.ps1`

一鍵式發行工具：
```powershell
.\quick-publish.ps1
```

自動處理：
- ✨ 檢查必要檔案
- ✨ 更新版本號
- ✨ 建置專案
- ✨ 驗證產物
- ✨ 發行到 Paradox Mods

### 5. 🖼️ 縮圖檢查工具
**檔案**：`check-thumbnail.ps1`

檢查和建立縮圖：
```powershell
.\check-thumbnail.ps1          # 檢查
.\check-thumbnail.ps1 -Create  # 建立預設縮圖
```

---

## 🎓 學習資源

### 完整的開發指南
**檔案**：`.github\copilot-instructions.md`

這是一份超詳細的開發指南，包含：
- Cities: Skylines 2 模組開發完整架構
- Harmony 補丁技術說明
- 多國語系系統
- .NET Framework 4.8.1 語法限制
- 建置與發佈流程
- 除錯與測試策略

---

## 📋 今後的發行流程

### 最簡單的方式（推薦）

```powershell
# 1. 確保已在遊戲中登入過（僅需一次）

# 2. 切換到專案目錄
cd e:\Code\CSL2\DemandModifier\DemandModifier\DemandModifier

# 3. 執行快速發行腳本
.\quick-publish.ps1

# 4. 按照提示輸入版本號和變更日誌

# 5. 完成！
```

### 手動方式（進階）

```powershell
# 1. 更新 Properties\PublishConfiguration.xml
#    - 修改 <ModVersion>
#    - 修改 <ChangeLog>

# 2. 建置
dotnet clean
dotnet build -c Release

# 3. 發行
dotnet publish /p:PublishProfile=PublishNewVersion

# 4. 提交到 Git
git add .
git commit -m "Release v0.0.14"
git tag v0.0.14
git push origin master --tags
```

---

## 🔄 版本號規則速記

| 從 | 到 | 使用時機 |
|----|-------|----------|
| 0.0.13 | 0.0.14 | Bug 修復、小改進 |
| 0.0.14 | 0.1.0 | 新增功能 |
| 0.1.0 | 1.0.0 | 正式發布、重大變更 |

---

## 📊 你的模組資訊

- **ModId**：123136
- **目前版本**：0.0.13
- **遊戲版本相容性**：1.2.*
- **Paradox Mods 頁面**：https://mods.paradoxplaza.com/mods/123136/Windows
- **GitHub 儲存庫**：https://github.com/ChengBoChuan/demandmodifier

---

## 🆘 如果還有問題

### 1. 檢查是否已登入
```powershell
# 檢查登入 token 是否存在
Test-Path "$env:LOCALAPPDATA\..\LocalLow\Colossal Order\Cities Skylines II\.paradox"
```

### 2. 查看詳細錯誤
```powershell
# 直接執行 ModPublisher 查看詳細訊息
& "E:\SteamLibrary\steamapps\common\Cities Skylines II\Cities2_Data\Content\Game\.ModdingToolchain\ModPublisher\ModPublisher.exe" `
  NewVersion `
  "E:\Code\CSL2\DemandModifier\DemandModifier\DemandModifier\Properties\PublishConfiguration.xml" `
  -c "C:\Users\zheng\AppData\LocalLow\Colossal Order\Cities Skylines II\Mods\DemandModifier" `
  -v
```

### 3. 檢查建置產物
```powershell
# 確認 DLL 存在
Test-Path "bin\Release\net48\DemandModifier.dll"

# 確認語系檔案存在
Get-ChildItem "bin\Release\net48\l10n\*.json"
```

### 4. 檢查縮圖
```powershell
.\check-thumbnail.ps1
```

---

## 💡 專業提示

### 提示 1：使用測試模式
在正式發行前，先用測試模式確認建置無誤：
```powershell
.\quick-publish.ps1 -TestOnly
```

### 提示 2：保持 Token 有效
- 定期在遊戲中登入（每月一次）
- 登入時選擇「記住我」
- 避免使用遊戲的離線模式

### 提示 3：版本號管理
- 使用語意化版本（Semantic Versioning）
- 每次發行前更新 CHANGELOG.md
- Git tag 與版本號保持一致

### 提示 4：測試再發行
- 先在本機遊戲中測試
- 確認所有功能正常
- 檢查多國語系翻譯
- 再執行發行命令

---

## ✅ 檢查清單

複製此清單，每次發行時確認：

### 發行前
- [ ] 已在遊戲中登入 Paradox 帳號
- [ ] 程式碼已測試無誤
- [ ] 版本號已更新
- [ ] ChangeLog 已填寫
- [ ] 縮圖檔案存在（256x256 PNG）

### 發行中
- [ ] `dotnet clean` 成功
- [ ] `dotnet build -c Release` 成功
- [ ] `dotnet publish /p:PublishProfile=PublishNewVersion` 成功

### 發行後
- [ ] Paradox Mods 頁面已更新
- [ ] 版本號顯示正確
- [ ] Git 已提交和標記
- [ ] CHANGELOG.md 已更新

---

## 🎉 恭喜！

你現在已經：
- ✅ 了解錯誤的真正原因
- ✅ 知道如何解決登入問題
- ✅ 擁有完整的發行文件
- ✅ 有便利的自動化腳本
- ✅ 掌握整個發行流程

**祝你發行順利！** 🚀

如果遇到其他問題，可以參考：
- `docs\版本發行完整指南.md` - 完整指南
- `docs\快速參考.md` - 速查表
- `docs\解決登入問題.md` - 登入問題詳解
- `.github\copilot-instructions.md` - 開發指南

---

**文件建立日期**：2025-10-27  
**問題解決者**：GitHub Copilot  
**DemandModifier 版本**：0.0.13
