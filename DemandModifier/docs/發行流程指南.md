# DemandModifier ç™¼è¡Œæ–°ç‰ˆæœ¬å®Œæ•´æµç¨‹

## âš ï¸ é‡è¦æé†’

**æ¯æ¬¡ç™¼è¡Œæ–°ç‰ˆæœ¬å‰ï¼Œå¿…é ˆå®Œæˆä»¥ä¸‹å…©é …ï¼š**
1. âœ… æ›´æ–° `ModVersion` ç‰ˆæœ¬è™Ÿï¼ˆä½¿ç”¨èªæ„åŒ–ç‰ˆæœ¬ï¼‰
2. âœ… å¡«å¯« `ChangeLog`ï¼ˆ**çµ•å°ä¸å¯ç©ºç™½ï¼**ï¼‰

## ğŸ“ ç™¼è¡Œå‰æª¢æŸ¥æ¸…å–®

### 1. æ›´æ–° PublishConfiguration.xml

ç·¨è¼¯ `Properties/PublishConfiguration.xml`ï¼š

```xml
<!-- æ­¥é©Ÿ 1: æ›´æ–°ç‰ˆæœ¬è™Ÿ -->
<ModVersion Value="0.0.14" />  <!-- å¾ 0.0.13 â†’ 0.0.14 -->

<!-- æ­¥é©Ÿ 2: å¡«å¯«è®Šæ›´æ—¥èªŒï¼ˆå¿…å¡«ï¼ï¼‰ -->
<ChangeLog Value="ä¿®æ­£é›»åŠ›ç³»çµ±éŒ¯èª¤ã€æ–°å¢æ°´è³‡æºæ§åˆ¶åŠŸèƒ½" />

<!-- æˆ–ä½¿ç”¨å¤šè¡Œæ ¼å¼ï¼š -->
<ChangeLog>
- æ–°å¢ç„¡é™é›»åŠ›åŠŸèƒ½
- ä¿®æ­£å•†æ¥­éœ€æ±‚éŒ¯èª¤
- æ›´æ–°ç¹é«”ä¸­æ–‡ç¿»è­¯
</ChangeLog>
```

### 2. ç¢ºèªéŠæˆ²ç‰ˆæœ¬ç›¸å®¹æ€§

```xml
<GameVersion Value="1.2.*" />  <!-- ç¢ºèªæ”¯æ´çš„éŠæˆ²ç‰ˆæœ¬ -->
```

### 3. æª¢æŸ¥ ModId æ˜¯å¦æ­£ç¢º

```xml
<ModId Value="123136" />  <!-- ä½ çš„ Mod IDï¼Œé¦–æ¬¡ç™¼ä½ˆå¾Œä¸æ‡‰æ›´æ”¹ -->
```

## ğŸš€ ç™¼è¡Œå‘½ä»¤

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Visual Studio ç™¼è¡Œè¨­å®šæª”ï¼ˆæ¨è–¦ï¼‰

1. **åœ¨ Visual Studio ä¸­**ï¼š
   - å³éµé»æ“Šå°ˆæ¡ˆ â†’ **ç™¼è¡Œ (Publish)**
   - é¸æ“‡ `PublishNewVersion` è¨­å®šæª”
   - é»æ“Š **ç™¼è¡Œ**

### æ–¹å¼äºŒï¼šä½¿ç”¨ PowerShell å‘½ä»¤åˆ—

```powershell
# ç¢ºä¿åœ¨å°ˆæ¡ˆç›®éŒ„ä¸‹
cd E:\Code\CSL2\DemandModifier\DemandModifier\DemandModifier

# æ–¹å¼ 2A: ä½¿ç”¨å®Œæ•´ç™¼è¡Œå‘½ä»¤
dotnet publish -c Release /p:PublishProfile=PublishNewVersion

# æ–¹å¼ 2B: ä½¿ç”¨ MSBuildï¼ˆå¦‚æœ dotnet publish å¤±æ•—ï¼‰
msbuild /t:Publish /p:Configuration=Release /p:PublishProfile=PublishNewVersion
```

## âŒ å¸¸è¦‹éŒ¯èª¤èˆ‡è§£æ±ºæ–¹æ¡ˆ

### éŒ¯èª¤ 1: è¿”å›ç¢¼ -1
```
éŒ¯èª¤ MSB3073: ModPublisher.exe å‘½ä»¤ä»¥è¿”å›ç¢¼ -1 çµæŸ
```

**åŸå› èˆ‡è§£æ±ºæ–¹æ¡ˆï¼š**

| åŸå›  | æª¢æŸ¥é …ç›® | è§£æ±ºæ–¹æ³• |
|------|----------|----------|
| ChangeLog ç‚ºç©º | `<ChangeLog Value="" />` | **å¿…é ˆå¡«å¯«è®Šæ›´å…§å®¹** |
| ModVersion æœªæ›´æ–° | ç‰ˆæœ¬è™Ÿèˆ‡ç·šä¸Šç›¸åŒ | éå¢ç‰ˆæœ¬è™Ÿï¼ˆå¦‚ 0.0.13 â†’ 0.0.14ï¼‰ |
| ModId éŒ¯èª¤ | `<ModId Value="123136" />` | ç¢ºèª ModId æ­£ç¢ºï¼ˆé¦–æ¬¡ç™¼ä½ˆå¾Œç²å¾—ï¼‰ |
| ç¶²è·¯å•é¡Œ | ç„¡æ³•é€£æ¥ PDX Mods | æª¢æŸ¥ç¶²è·¯é€£ç·š |

### éŒ¯èª¤ 2: æ‰¾ä¸åˆ° ModPublisher.exe
```
ç„¡æ³•æ‰¾åˆ° E:\SteamLibrary\...\ModPublisher.exe
```

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. ç¢ºèªéŠæˆ²å®Œæ•´å®‰è£
2. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸ `CSII_TOOLPATH` æ˜¯å¦è¨­å®šæ­£ç¢ºï¼š
   ```powershell
   $env:CSII_TOOLPATH
   # æ‡‰é¡¯ç¤ºä½ çš„ CS2 Modding SDK è·¯å¾‘
   ```

### éŒ¯èª¤ 3: ç·¨è­¯å¤±æ•—
```
ç·¨è­¯å¤±æ•—ï¼Œç„¡æ³•ç”¢ç”Ÿ DLL
```

**è§£æ±ºæ–¹æ¡ˆï¼š**
```powershell
# å…ˆæ¸…ç†å°ˆæ¡ˆ
dotnet clean

# é‡æ–°å»ºç½®
dotnet build -c Release

# æª¢æŸ¥éŒ¯èª¤è¨Šæ¯
```

## ğŸ“¦ å®Œæ•´ç™¼è¡Œæµç¨‹ï¼ˆæ¨™æº–ç¨‹åºï¼‰

### ç¬¬ä¸€æ­¥ï¼šæœ¬æ©Ÿé–‹ç™¼èˆ‡æ¸¬è©¦

```powershell
# 1. é–‹ç™¼å®Œæˆå¾Œï¼Œå…ˆæœ¬æ©Ÿæ¸¬è©¦
dotnet build -c Release

# 2. è¤‡è£½åˆ°éŠæˆ² Mods ç›®éŒ„æ¸¬è©¦
$modsPath = "$env:LOCALAPPDATA\..\LocalLow\Colossal Order\Cities Skylines II\Mods\DemandModifier"
Copy-Item "bin\Release\net48\*" $modsPath -Recurse -Force

# 3. å•Ÿå‹•éŠæˆ²æ¸¬è©¦åŠŸèƒ½
```

### ç¬¬äºŒæ­¥ï¼šæ›´æ–°ç‰ˆæœ¬è³‡è¨Š

```powershell
# ç·¨è¼¯ Properties/PublishConfiguration.xml
code Properties/PublishConfiguration.xml

# å¿…é ˆæ›´æ–°ï¼š
# - ModVersion: 0.0.13 â†’ 0.0.14
# - ChangeLog: å¡«å¯«è®Šæ›´å…§å®¹
```

### ç¬¬ä¸‰æ­¥ï¼šåŸ·è¡Œç™¼è¡Œ

```powershell
# æ–¹å¼ 1: ä½¿ç”¨ dotnet publish
dotnet publish -c Release /p:PublishProfile=PublishNewVersion

# æ–¹å¼ 2: ä½¿ç”¨ MSBuildï¼ˆå¦‚æœä¸Šé¢å¤±æ•—ï¼‰
msbuild /t:Publish /p:Configuration=Release /p:PublishProfile=PublishNewVersion
```

### ç¬¬å››æ­¥ï¼šé©—è­‰ç™¼è¡Œ

1. æª¢æŸ¥çµ‚ç«¯è¼¸å‡ºæ˜¯å¦æœ‰éŒ¯èª¤
2. å‰å¾€ [PDX Mods](https://mods.paradoxplaza.com/) ç¢ºèªæ–°ç‰ˆæœ¬å·²ä¸Šç·š
3. æª¢æŸ¥ç‰ˆæœ¬è™Ÿã€ChangeLog æ˜¯å¦æ­£ç¢ºé¡¯ç¤º

## ğŸ”„ èªæ„åŒ–ç‰ˆæœ¬è™Ÿè¦å‰‡

ä½¿ç”¨ `X.Y.Z` æ ¼å¼ï¼š

| ç‰ˆæœ¬é¡å‹ | ç¯„ä¾‹ | ä½¿ç”¨æ™‚æ©Ÿ |
|---------|------|----------|
| **ä¸»ç‰ˆæœ¬ (X)** | 1.0.0 â†’ 2.0.0 | é‡å¤§è®Šæ›´ã€ä¸ç›¸å®¹æ›´æ–° |
| **æ¬¡ç‰ˆæœ¬ (Y)** | 0.1.0 â†’ 0.2.0 | æ–°å¢åŠŸèƒ½ã€å‘ä¸‹ç›¸å®¹ |
| **ä¿®è¨‚ç‰ˆ (Z)** | 0.0.1 â†’ 0.0.2 | éŒ¯èª¤ä¿®æ­£ã€å°èª¿æ•´ |

**ç›®å‰ç‰ˆæœ¬ï¼š** 0.0.13 â†’ å»ºè­°ä¸‹æ¬¡æ›´æ–°ç‚º **0.0.14** æˆ– **0.1.0**ï¼ˆå¦‚æœ‰æ–°åŠŸèƒ½ï¼‰

## ğŸ“‹ ç™¼è¡Œæª¢æŸ¥æ¸…å–®ç¯„æœ¬

è¤‡è£½æ­¤ç¯„æœ¬ï¼Œæ¯æ¬¡ç™¼è¡Œå‰é€é …æª¢æŸ¥ï¼š

```
ç™¼è¡Œå‰æª¢æŸ¥ - ç‰ˆæœ¬ X.Y.Z
==========================

â–¡ ç¨‹å¼ç¢¼åŠŸèƒ½å·²å®Œæˆä¸¦æ¸¬è©¦
â–¡ æœ¬æ©ŸéŠæˆ²æ¸¬è©¦é€šé
â–¡ æ‰€æœ‰èªç³»æª”æ¡ˆå·²æ›´æ–°ï¼ˆ7 ç¨®èªè¨€ï¼‰
â–¡ PublishConfiguration.xml å·²æ›´æ–°ï¼š
  â–¡ ModVersion å·²éå¢
  â–¡ ChangeLog å·²å¡«å¯«ï¼ˆä¸ç‚ºç©ºï¼‰
  â–¡ GameVersion ç›¸å®¹æ€§å·²ç¢ºèª
  â–¡ LongDescription å·²æ›´æ–°ï¼ˆå¦‚éœ€è¦ï¼‰
â–¡ å°ˆæ¡ˆå·²æ¸…ç†ä¸¦é‡æ–°å»ºç½®ï¼ˆdotnet clean + buildï¼‰
â–¡ ç„¡ç·¨è­¯éŒ¯èª¤å’Œè­¦å‘Š

åŸ·è¡Œç™¼è¡Œï¼š
â–¡ dotnet publish -c Release /p:PublishProfile=PublishNewVersion
â–¡ ç™¼è¡ŒæˆåŠŸï¼ˆç„¡éŒ¯èª¤è¨Šæ¯ï¼‰
â–¡ PDX Mods é é¢å·²æ›´æ–°
â–¡ ç‰ˆæœ¬è™Ÿæ­£ç¢ºé¡¯ç¤º
â–¡ ChangeLog æ­£ç¢ºé¡¯ç¤º
```

## ğŸ› ï¸ é€²éšï¼šè‡ªå‹•åŒ–ç™¼è¡Œè…³æœ¬

å»ºç«‹ `Properties/PublishHelper.ps1`ï¼š

```powershell
# ç™¼è¡Œè¼”åŠ©è…³æœ¬
param(
    [string]$NewVersion,
    [string]$ChangeLog
)

if (-not $NewVersion -or -not $ChangeLog) {
    Write-Host "ä½¿ç”¨æ–¹å¼: .\PublishHelper.ps1 -NewVersion '0.0.14' -ChangeLog 'ä¿®æ­£éŒ¯èª¤'" -ForegroundColor Yellow
    exit 1
}

Write-Host "æº–å‚™ç™¼è¡Œæ–°ç‰ˆæœ¬: $NewVersion" -ForegroundColor Cyan

# 1. æ›´æ–° PublishConfiguration.xml
$configPath = "PublishConfiguration.xml"
$xml = [xml](Get-Content $configPath)
$xml.Publish.ModVersion.Value = $NewVersion
$xml.Publish.ChangeLog.Value = $ChangeLog
$xml.Save($configPath)
Write-Host "âœ“ å·²æ›´æ–°ç‰ˆæœ¬è™Ÿå’Œ ChangeLog" -ForegroundColor Green

# 2. æ¸…ç†ä¸¦é‡æ–°å»ºç½®
Write-Host "åŸ·è¡Œæ¸…ç†..." -ForegroundColor Cyan
dotnet clean | Out-Null
dotnet build -c Release
if ($LASTEXITCODE -ne 0) {
    Write-Host "âœ— å»ºç½®å¤±æ•—ï¼" -ForegroundColor Red
    exit 1
}
Write-Host "âœ“ å»ºç½®æˆåŠŸ" -ForegroundColor Green

# 3. åŸ·è¡Œç™¼è¡Œ
Write-Host "é–‹å§‹ç™¼è¡Œ..." -ForegroundColor Cyan
dotnet publish -c Release /p:PublishProfile=PublishNewVersion
if ($LASTEXITCODE -eq 0) {
    Write-Host "âœ“ ç™¼è¡ŒæˆåŠŸï¼" -ForegroundColor Green
    Write-Host "è«‹å‰å¾€ PDX Mods ç¢ºèªï¼šhttps://mods.paradoxplaza.com/" -ForegroundColor Yellow
} else {
    Write-Host "âœ— ç™¼è¡Œå¤±æ•—ï¼" -ForegroundColor Red
    exit 1
}
```

**ä½¿ç”¨ç¯„ä¾‹ï¼š**
```powershell
cd Properties
.\PublishHelper.ps1 -NewVersion "0.0.14" -ChangeLog "ä¿®æ­£é›»åŠ›ç³»çµ±éŒ¯èª¤ã€æ–°å¢æ°´è³‡æºæ§åˆ¶"
```

## ğŸ“š åƒè€ƒè³‡æº

- [Paradox Wiki - Modding Toolchain](https://cs2.paradoxwikis.com/Modding_Toolchain#C#_Mod_Project_Template)
- [PDX Mods å®˜æ–¹ç¶²ç«™](https://mods.paradoxplaza.com/)
- [å°ˆæ¡ˆé–‹ç™¼æŒ‡å—](../copilot-instructions.md)

---

**æœ€å¾Œæé†’ï¼š** æ¯æ¬¡ç™¼è¡Œå‰ï¼Œè«‹ç¢ºä¿ `ChangeLog` ä¸ç‚ºç©ºç™½ï¼Œé€™æ˜¯æœ€å¸¸è¦‹çš„éŒ¯èª¤åŸå› ï¼
